<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analyseur d'Ouvertures Chess.com</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/cm-chessboard@7.11.0/assets/chessboard.css"
  />
  <link rel="stylesheet" href="./src/ui/main.css" />
</head>

<body>
  <div class="container">
    <h1>♟️ Analyseur d'Ouvertures Chess.com</h1>
    <p class="subtitle">Découvrez les ouvertures préférées de n'importe quel joueur</p>

    <div class="mode-toggle" role="tablist" aria-label="Mode d'analyse">
      <button type="button" class="mode-btn is-active" data-mode="opponent" id="modeOpponent" aria-pressed="true">
        Analyser un adversaire
      </button>
      <button type="button" class="mode-btn" data-mode="self" id="modeSelf" aria-pressed="false">
        M'analyser moi
      </button>
    </div>

    <div class="search-section" id="controlPanel">
      <div class="control-field">
        <label class="control-label" for="username">Pseudo Chess.com</label>
        <input
          type="text"
          id="username"
          placeholder="Entrez le pseudo Chess.com (ex: hikaru)"
          autocomplete="username"
        />
      </div>
      <div class="control-field">
        <label class="control-label" for="speedSelect">Cadence cible</label>
        <select id="speedSelect">
          <option value="auto">Auto (selon stats)</option>
          <option value="bullet">Bullet</option>
          <option value="blitz">Blitz</option>
          <option value="rapid">Rapid</option>
          <option value="classical">Classical</option>
          <option value="correspondence">Correspondence</option>
        </select>
      </div>
      <div class="control-field">
        <label class="control-label" for="ratingOffset">Décalage Elo Explorer</label>
        <input type="number" id="ratingOffset" value="0" step="50" />
      </div>
      <div class="control-field">
        <label class="control-label" for="gmMode">Théorie GM</label>
        <select id="gmMode">
          <option value="top1">Top 1</option>
          <option value="topK">Top K</option>
          <option value="coverage">Couverture %</option>
        </select>
      </div>
      <div class="control-field" id="gmTopKField" style="display: none;">
        <label class="control-label" for="gmTopK">K (Top K)</label>
        <input type="number" id="gmTopK" min="1" max="6" value="3" />
      </div>
      <div class="control-field" id="gmCoverageField" style="display: none;">
        <label class="control-label" for="gmCoverage">Couverture minimale (%)</label>
        <input type="number" id="gmCoverage" min="10" max="100" value="70" step="5" />
      </div>
      <div class="control-field">
        <label class="control-label" for="minMasterGames">Volume Masters minimum</label>
        <input type="number" id="minMasterGames" min="10" max="500" step="10" value="50" />
      </div>
      <div class="control-field toggle-field" id="engineSettings">
        <span class="control-label">Moteur local</span>
        <label class="engine-toggle" for="engineEnabled">
          <input type="checkbox" id="engineEnabled" />
          <span>Activer Stockfish local</span>
        </label>
        <input
          type="text"
          id="enginePath"
          placeholder="Chemin Worker Stockfish (optionnel)"
          autocomplete="off"
        />
        <div class="engine-options">
          <div class="engine-option">
            <label for="engineDepth">Profondeur</label>
            <input type="number" id="engineDepth" min="6" max="30" value="18" />
          </div>
          <div class="engine-option">
            <label for="engineMultiPv">MultiPV</label>
            <input type="number" id="engineMultiPv" min="1" max="5" value="3" />
          </div>
        </div>
      </div>
      <button id="analyzeBtn" class="primary-action">Lancer l'analyse</button>
    </div>

    <div id="loading" class="loading" style="display: none;">
      ⏳ Chargement des parties en cours...
    </div>

    <div id="error" class="error" style="display: none;"></div>

    <div id="playerInfo" style="display: none;"></div>

    <div id="prepActions" class="prep-actions" style="display: none;">
      <button type="button" id="exportJsonBtn" class="secondary-button">Export JSON</button>
      <button type="button" id="exportMarkdownBtn" class="secondary-button">Export Markdown</button>
      <button type="button" id="exportPdfBtn" class="secondary-button">PDF imprimable</button>
    </div>

    <div id="openingsSection" class="openings-section">
      <div class="openings-card">
        <h3>
          <span class="chess-piece white-piece">♔</span>
          Ouvertures avec les Blancs
        </h3>
        <div id="whiteOpenings"></div>
      </div>

      <div class="openings-card">
        <h3>
          <span class="chess-piece black-piece">♚</span>
          Ouvertures avec les Noirs
        </h3>
        <div id="blackOpenings"></div>
      </div>
    </div>
  </div>

  <div id="boardPreview">
    <div
      id="boardPreviewBoard"
      class="board-preview-board"
      aria-hidden="true"
    ></div>
    <div class="board-preview-caption" id="boardPreviewCaption"></div>
  </div>

  <div
    id="lineModal"
    class="line-modal"
    role="dialog"
    aria-modal="true"
    aria-hidden="true"
  >
    <div class="line-modal-dialog">
      <div class="line-modal-header">
        <div class="line-modal-title" id="lineModalTitle">Séquence</div>
        <button
          type="button"
          class="line-modal-close"
          id="lineModalClose"
          aria-label="Fermer"
        >
          ×
        </button>
      </div>
      <div class="line-modal-content">
        <div class="line-modal-board" id="lineModalBoard" aria-hidden="false"></div>
        <div class="line-modal-sidebar">
          <div class="line-modal-subtitle" id="lineModalSummary"></div>
          <div class="line-modal-controls">
            <button type="button" id="lineModalStart">⏮ Début</button>
            <button type="button" id="lineModalPrev">◀️ Précédent</button>
            <button type="button" id="lineModalNext">▶️ Suivant</button>
            <button type="button" id="lineModalEnd">⏭ Fin</button>
          </div>
          <div class="line-modal-moves" id="lineModalMoves"></div>
        </div>
      </div>
      <div class="line-modal-footer">
        <a
          href="https://lichess.org/analysis"
          target="_blank"
          rel="noopener"
          id="lineModalLichess"
          class="line-modal-link"
        >
          ↗ Voir la position sur Lichess
        </a>
      </div>
    </div>
  </div>

    <script type="module" src="./dist/main.js"></script>


</body>

</html>
